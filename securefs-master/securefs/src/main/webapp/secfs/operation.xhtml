<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:rich="http://richfaces.org/rich" xmlns:a4j="http://richfaces.org/a4j" template="/resources/template.xhtml">

	<div class="container">
		<h:messages errorClass="bg-danger" warnClass="bg-warning" infoClass="bg-success" />
	</div>

	<ui:define name="container1">
		<div class="col-md-6">
			<p></p>
			<ui:include src="validate.xhtml" />
		</div>
		<div class="col-md-6">
			<p></p>
			<h2>Monitor</h2>
			<h:form id="statusForm">
				<a4j:poll render="@form" interval="5000" enabled="#{statusMonitor.active}" />

				<h:panelGrid columns="2" styleClass="table-bordered table-hover">
					<h:panelGroup>
						<h:outputLabel value="Cache:" />
						<h:outputText value="#{statusMonitor.cacheName}" />
					</h:panelGroup>
					<h:commandButton actionListener="#{statusMonitor.toggleActive()}"
						value="#{statusMonitor.active ? 'Deactivate' : 'Activate'} Monitor">
						<f:ajax render="@form" />
					</h:commandButton>
					<h:outputLabel value="Active FileSystems" />
					<h:outputText value="#{statusMonitor.activeFileSystems}" />
					<h:outputLabel value="Active Files" />
					<h:outputText value="#{statusMonitor.activeFiles}" />
					<h:outputLabel value="ClusterNodes" />
					<h:outputText value="#{statusMonitor.clusterAddresses}" />
				</h:panelGrid>
				<rich:dataTable id="statusTable" value="#{statusMonitor.clusterStates}" var="item" styleClass="table-bordered table-hover">
					<rich:column colspan="6">
						<h:commandLink actionListener="#{item.state.toggleCollapsed()}">
							<f:ajax render="statusTable"/>
							<rich:collapsibleSubTableToggler for="subTable" />
						</h:commandLink>
						<h:outputText value="#{item.location}" />
					</rich:column>
					<rich:collapsibleSubTable id="subTable" value="#{item.list}" var="entry" expanded="#{!item.state.collapsed}"
						expandMode="ajax">
						<rich:column>
							<h:outputText value="#{entry.key}" />
						</rich:column>
						<rich:column>
							<h:outputText value="#{entry.value}" />
						</rich:column>
					</rich:collapsibleSubTable>
				</rich:dataTable>
			</h:form>
		</div>
	</ui:define>
</ui:composition>